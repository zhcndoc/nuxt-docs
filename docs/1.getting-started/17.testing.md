---
title: æµ‹è¯•å·¥å…·
description: å¦‚ä½•æµ‹è¯•ä½ çš„ Nuxt åº”ç”¨ã€‚
navigation.icon: i-lucide-circle-check
---

::tip
å¦‚æœä½ æ˜¯æ¨¡å—ä½œè€…ï¼Œå¯ä»¥åœ¨ [æ¨¡å—ä½œè€…æŒ‡å—](/docs/4.x/guide/modules/testing) ä¸­æ‰¾åˆ°æ›´å…·ä½“çš„ä¿¡æ¯ã€‚
::

:video-accordion{title="è§‚çœ‹ Alexander Lichter å…³äºä½¿ç”¨ @nuxt/test-utils å…¥é—¨çš„è§†é¢‘" videoId="yGzwk9xi9gU"}

## å®‰è£…

ä¸ºäº†è®©ä½ ç®¡ç†å…¶ä»–æµ‹è¯•ä¾èµ–ï¼Œ`@nuxt/test-utils` é™„å¸¦äº†å„ç§å¯é€‰çš„ peer ä¾èµ–ã€‚ä¾‹å¦‚ï¼š

- ä½ å¯ä»¥åœ¨è¿è¡Œæ—¶ Nuxt ç¯å¢ƒä¸­é€‰æ‹© `happy-dom` æˆ– `jsdom`
- ä½ å¯ä»¥ä¸ºç«¯åˆ°ç«¯æµ‹è¯•è¿è¡Œå™¨é€‰æ‹© `vitest`ã€`cucumber`ã€`jest` æˆ– `playwright`
- ä»…å½“ä½ å¸Œæœ›ä½¿ç”¨å†…ç½®çš„æµè§ˆå™¨æµ‹è¯•å·¥å…·ï¼ˆä¸”ä¸ä½¿ç”¨ `@playwright/test` ä½œä¸ºæµ‹è¯•è¿è¡Œå™¨ï¼‰æ—¶ï¼Œæ‰éœ€è¦ `playwright-core`

::code-group{sync="pm"}
```bash [npm]
npm i --save-dev @nuxt/test-utils vitest @vue/test-utils happy-dom playwright-core
```
```bash [yarn]
yarn add --dev @nuxt/test-utils vitest @vue/test-utils happy-dom playwright-core
```
```bash [pnpm]
pnpm add -D @nuxt/test-utils vitest @vue/test-utils happy-dom playwright-core
```
```bash [bun]
bun add --dev @nuxt/test-utils vitest @vue/test-utils happy-dom playwright-core
```
::

## å•å…ƒæµ‹è¯•

æˆ‘ä»¬ç›®å‰ä¸ºéœ€è¦ Nuxt è¿è¡Œæ—¶ç¯å¢ƒçš„ä»£ç æä¾›äº†ä¸€ä¸ªå•å…ƒæµ‹è¯•ç¯å¢ƒã€‚å½“å‰ã€Œä»…æ”¯æŒ `vitest`ã€ï¼ˆæ¬¢è¿è´¡çŒ®ä»¥æ·»åŠ å…¶ä»–è¿è¡Œæ—¶ï¼‰ã€‚

### è®¾ç½®

1. ï¼ˆå¯é€‰ï¼‰åœ¨ä½ çš„ `nuxt.config` æ–‡ä»¶ä¸­æ·»åŠ  `@nuxt/test-utils/module`ã€‚å®ƒä¼šå‘ Nuxt DevTools æ·»åŠ ä¸€ä¸ª Vitest é›†æˆï¼Œæ”¯æŒåœ¨å¼€å‘æ—¶è¿è¡Œä½ çš„å•å…ƒæµ‹è¯•ã€‚

   ```ts twoslash
   export default defineNuxtConfig({
     modules: [
       '@nuxt/test-utils/module',
     ],
   })
   ```

2. åˆ›å»ºä¸€ä¸ªåŒ…å«ä»¥ä¸‹å†…å®¹çš„ `vitest.config.ts`ï¼š

   ```ts twoslash
   import { defineConfig } from 'vitest/config'
   import { defineVitestProject } from '@nuxt/test-utils/config'

   export default defineConfig({
     test: {
       projects: [
         {
           test: {
             name: 'unit',
             include: ['test/unit/*.{test,spec}.ts'],
             environment: 'node',
           },
         },
         {
           test: {
             name: 'e2e',
             include: ['test/e2e/*.{test,spec}.ts'],
             environment: 'node',
           },
         },
         await defineVitestProject({
           test: {
             name: 'nuxt',
             include: ['test/nuxt/*.{test,spec}.ts'],
             environment: 'nuxt',
           },
         }),
       ],
     },
   })
   ```

::tip
åœ¨ä½ çš„ vitest é…ç½®ä¸­å¯¼å…¥ `@nuxt/test-utils` æ—¶ï¼Œå¿…é¡»åœ¨ `package.json` ä¸­æŒ‡å®š `"type": "module"` æˆ–è€…é€‚å½“é‡å‘½åä½ çš„ vitest é…ç½®æ–‡ä»¶ã€‚
> ä¾‹å¦‚ï¼š`vitest.config.m{ts,js}`ã€‚
::

::tip
å¯ä»¥ä½¿ç”¨ `.env.test` æ–‡ä»¶ä¸ºæµ‹è¯•è®¾ç½®ç¯å¢ƒå˜é‡ã€‚
::

### ä½¿ç”¨ Nuxt è¿è¡Œæ—¶ç¯å¢ƒ

ä½¿ç”¨ [Vitest é¡¹ç›®](https://vitest.dev/guide/projects.html#test-projects)ï¼Œä½ å¯ä»¥ç²¾ç¡®æ§åˆ¶å“ªäº›æµ‹è¯•åœ¨ä½•ç§ç¯å¢ƒä¸­è¿è¡Œï¼š

- **å•å…ƒæµ‹è¯•**ï¼šå°†å¸¸è§„å•å…ƒæµ‹è¯•æ”¾åœ¨ `test/unit/` â€”â€” è¿™äº›åœ¨ Node ç¯å¢ƒä¸­è¿è¡Œä»¥æé«˜é€Ÿåº¦
- **Nuxt æµ‹è¯•**ï¼šå°†ä¾èµ– Nuxt è¿è¡Œæ—¶ç¯å¢ƒçš„æµ‹è¯•æ”¾åœ¨ `test/nuxt/` â€”â€” è¿™äº›å°†åœ¨ Nuxt è¿è¡Œæ—¶ç¯å¢ƒä¸­è¿è¡Œ

#### å¯é€‰ï¼šç®€å•è®¾ç½®

å¦‚æœä½ æ›´å–œæ¬¢æ›´ç®€å•çš„è®¾ç½®å¹¶å¸Œæœ›æ‰€æœ‰æµ‹è¯•éƒ½åœ¨ Nuxt ç¯å¢ƒä¸­è¿è¡Œï¼Œå¯ä»¥ä½¿ç”¨åŸºç¡€é…ç½®ï¼š

```ts twoslash
import { defineVitestConfig } from '@nuxt/test-utils/config'

export default defineVitestConfig({
  test: {
    environment: 'nuxt',
    // ä½ å¯ä»¥å¯é€‰åœ°è®¾ç½® Nuxt ç‰¹å®šçš„ç¯å¢ƒé€‰é¡¹
    // environmentOptions: {
    //   nuxt: {
    //     rootDir: fileURLToPath(new URL('./playground', import.meta.url)),
    //     domEnvironment: 'happy-dom', // 'happy-dom'ï¼ˆé»˜è®¤ï¼‰æˆ– 'jsdom'
    //     overrides: {
    //       // ä½ æƒ³ä¼ å…¥çš„å…¶ä»– Nuxt é…ç½®
    //     }
    //   }
    // }
  },
})
```

å¦‚æœä½ ä½¿ç”¨é»˜è®¤çš„ `environment: 'nuxt'` çš„ç®€å•è®¾ç½®ï¼Œä½ å¯ä»¥æ ¹æ®éœ€è¦åœ¨æ¯ä¸ªæµ‹è¯•æ–‡ä»¶ä¸­é€šè¿‡ç‰¹æ®Šæ³¨é‡Šé€‰æ‹©é€€å‡º [Nuxt ç¯å¢ƒ](https://vitest.dev/guide/environment.html#test-environment)ã€‚

```ts twoslash
// @vitest-environment node
import { test } from 'vitest'

test('my test', () => {
  // ... åœ¨æ²¡æœ‰ Nuxt ç¯å¢ƒçš„æƒ…å†µä¸‹æµ‹è¯•ï¼
})
```

::warning
ä¸å»ºè®®ä½¿ç”¨è¿™ç§æ–¹æ³•ï¼Œå› ä¸ºå®ƒä¼šåˆ›å»ºä¸€ä¸ªæ··åˆç¯å¢ƒï¼Œå…¶ä¸­ Nuxt çš„ Vite æ’ä»¶ä¼šè¿è¡Œï¼Œä½† Nuxt å…¥å£å’Œ `nuxtApp` å¯èƒ½æ²¡æœ‰è¢«åˆå§‹åŒ–ã€‚è¿™å¯èƒ½å¯¼è‡´éš¾ä»¥è°ƒè¯•çš„é”™è¯¯ã€‚
::

### ç»„ç»‡ä½ çš„æµ‹è¯•

ä½¿ç”¨åŸºäºé¡¹ç›®çš„è®¾ç½®ï¼Œä½ å¯èƒ½ä¼šå¦‚ä¸‹ç»„ç»‡ä½ çš„æµ‹è¯•ï¼š

```bash [Directory structure]
test/
â”œâ”€â”€ e2e/
â”‚   â””â”€â”€ ssr.test.ts
â”œâ”€â”€ nuxt/
â”‚   â”œâ”€â”€ components.test.ts
â”‚   â””â”€â”€ composables.test.ts
â”œâ”€â”€ unit/
â”‚   â””â”€â”€ utils.test.ts
```

å½“ç„¶ä½ å¯ä»¥é€‰æ‹©ä»»æ„æµ‹è¯•ç»“æ„ï¼Œä½†å°† Nuxt è¿è¡Œæ—¶ç¯å¢ƒä¸ Nuxt ç«¯åˆ°ç«¯æµ‹è¯•åˆ†å¼€å¯¹æµ‹è¯•ç¨³å®šæ€§å¾ˆé‡è¦ã€‚

#### æµ‹è¯•ä¸­çš„ TypeScript æ”¯æŒ

é»˜è®¤æƒ…å†µä¸‹ï¼Œ`test/nuxt/` å’Œ `tests/nuxt/` ç›®å½•ä¸‹çš„æµ‹è¯•æ–‡ä»¶ä¼šè¢«åŒ…å«åœ¨ [Nuxt åº”ç”¨çš„ TypeScript ä¸Šä¸‹æ–‡](/docs/4.x/guide/concepts/typescript#how-nuxt-uses-project-references) ä¸­ã€‚è¿™æ„å‘³ç€å®ƒä»¬èƒ½å¤Ÿè¯†åˆ« Nuxt çš„åˆ«åï¼ˆå¦‚ `~/`ã€`@/`ã€`#imports`ï¼‰ï¼Œå¹¶ä¸” TypeScript ä¹Ÿä¼šè¯†åˆ«åœ¨ä½ çš„ Nuxt åº”ç”¨ä¸­å¯ç”¨çš„è‡ªåŠ¨å¯¼å…¥ã€‚

::tip
è¿™ç¬¦åˆæ¨èçš„ç»“æ„ï¼Œåªæœ‰éœ€è¦ Nuxt è¿è¡Œæ—¶ç¯å¢ƒçš„æµ‹è¯•æ‰æ”¾åœ¨è¿™äº›ç›®å½•ä¸­ã€‚å…¶ä»–ç›®å½•ï¼ˆå¦‚ `test/unit/`ï¼‰ä¸­çš„å•å…ƒæµ‹è¯•å¯ä»¥æ ¹æ®éœ€è¦æ‰‹åŠ¨æ·»åŠ ã€‚
::

##### æ·»åŠ å…¶ä»–æµ‹è¯•ç›®å½•

å¦‚æœæ‚¨åœ¨ Nuxt Vitest ç¯å¢ƒä¸­è¿è¡Œçš„å…¶ä»–ç›®å½•ä¸­æœ‰æµ‹è¯•ï¼Œæ‚¨å¯ä»¥é€šè¿‡å°†å®ƒä»¬æ·»åŠ åˆ°é…ç½®ä¸­ï¼Œå°†å®ƒä»¬åŒ…å«åœ¨ Nuxt åº”ç”¨ç¨‹åº TypeScript ä¸Šä¸‹æ–‡ä¸­ï¼š

<!-- @case-police-ignore tsConfig -->

```ts [nuxt.config.ts]
export default defineNuxtConfig({
  typescript: {
    tsConfig: {
      include: [
        // this path is relative to the generated .nuxt/tsconfig.json
        '../test/other-nuxt-context/**/*',
      ],
    },
  },
})
```

::important
å•å…ƒæµ‹è¯•ä¸åº”ä¾èµ–äº Nuxt è¿è¡Œæ—¶åŠŸèƒ½ï¼Œå¦‚è‡ªåŠ¨å¯¼å…¥æˆ–ç»„åˆå‡½æ•°ã€‚åªæœ‰å½“ä½ çš„æµ‹è¯•ä»æºæ–‡ä»¶ï¼ˆä¾‹å¦‚ `~/utils/helpers`ï¼‰å¯¼å…¥æ—¶ï¼Œæ‰æ·»åŠ  TypeScript è·¯å¾„åˆ«åæ”¯æŒï¼Œè€Œä¸æ˜¯é’ˆå¯¹ Nuxt ç‰¹å®šåŠŸèƒ½ã€‚
::

#### è¿è¡Œæµ‹è¯•

ä½¿ç”¨é¡¹ç›®è®¾ç½®ï¼Œä½ å¯ä»¥è¿è¡Œä¸åŒçš„æµ‹è¯•å¥—ä»¶ï¼š

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
npx vitest

# ä»…è¿è¡Œå•å…ƒæµ‹è¯•
npx vitest --project unit

# ä»…è¿è¡Œ Nuxt æµ‹è¯•
npx vitest --project nuxt

# ä»¥ç›‘å¬æ¨¡å¼è¿è¡Œæµ‹è¯•
npx vitest --watch
```

::warning
å½“ä½ åœ¨ Nuxt ç¯å¢ƒä¸­è¿è¡Œæµ‹è¯•æ—¶ï¼Œå®ƒä»¬å°†è¿è¡Œåœ¨ [`happy-dom`](https://github.com/capricorn86/happy-dom) æˆ– [`jsdom`](https://github.com/jsdom/jsdom) ç¯å¢ƒä¸­ã€‚åœ¨æµ‹è¯•è¿è¡Œä¹‹å‰ï¼Œä¸€ä¸ªå…¨å±€çš„ Nuxt åº”ç”¨å°†è¢«åˆå§‹åŒ–ï¼ˆä¾‹å¦‚ï¼Œä¼šè¿è¡Œä½ åœ¨ `app.vue` ä¸­å®šä¹‰çš„ä»»ä½•æ’ä»¶æˆ–ä»£ç ï¼‰ã€‚

è¿™æ„å‘³ç€ä½ åœ¨æµ‹è¯•ä¸­åº”è¯¥ç‰¹åˆ«æ³¨æ„ä¸è¦å»æ”¹å˜å…¨å±€çŠ¶æ€ï¼ˆæˆ–è€…å¦‚æœéœ€è¦æ”¹å˜ï¼Œæµ‹è¯•åè¯·åŠ¡å¿…é‡ç½®å®ƒï¼‰ã€‚
::

### ğŸ­ å†…ç½®æ¨¡æ‹Ÿ

`@nuxt/test-utils` ä¸º DOM ç¯å¢ƒæä¾›äº†ä¸€äº›å†…ç½®æ¨¡æ‹Ÿã€‚

#### `intersectionObserver`

é»˜è®¤ `true`ï¼Œåˆ›å»ºä¸€ä¸ªä¸å…·åŠŸèƒ½æ€§çš„ IntersectionObserver API çš„å ä½ç±»

#### `indexedDB`

é»˜è®¤ `false`ï¼Œä½¿ç”¨ [`fake-indexeddb`](https://github.com/dumbmatter/fakeIndexedDB) åˆ›å»ºä¸€ä¸ªåŠŸèƒ½æ€§çš„ IndexedDB API æ¨¡æ‹Ÿ

è¿™äº›å¯ä»¥åœ¨ä½ çš„ `vitest.config.ts` æ–‡ä»¶çš„ `environmentOptions` éƒ¨åˆ†è¿›è¡Œé…ç½®ï¼š

```ts twoslash
import { defineVitestConfig } from '@nuxt/test-utils/config'

export default defineVitestConfig({
  test: {
    environmentOptions: {
      nuxt: {
        mock: {
          intersectionObserver: true,
          indexedDb: true,
        },
      },
    },
  },
})
```

### ğŸ› ï¸ å¸®åŠ©å‡½æ•°

`@nuxt/test-utils` æä¾›äº†è®¸å¤šå¸®åŠ©å‡½æ•°ä»¥ä¾¿æ›´æ–¹ä¾¿åœ°æµ‹è¯• Nuxt åº”ç”¨ã€‚

#### `mountSuspended`

`mountSuspended` å…è®¸ä½ åœ¨ Nuxt ç¯å¢ƒä¸­æŒ‚è½½ä»»æ„ Vue ç»„ä»¶ï¼Œæ”¯æŒå¼‚æ­¥è®¾ç½®å¹¶èƒ½å¤Ÿè®¿é—®æ¥è‡ª Nuxt æ’ä»¶çš„æ³¨å…¥ã€‚

::note
åœ¨å†…éƒ¨ï¼Œ`mountSuspended` å°è£…äº†æ¥è‡ª `@vue/test-utils` çš„ `mount`ï¼Œå› æ­¤ä½ å¯ä»¥æŸ¥çœ‹ [Vue Test Utils æ–‡æ¡£](https://test-utils.vuejs.org/guide/) ä»¥äº†è§£å¯ä¼ å…¥é€‰é¡¹ä»¥åŠå¦‚ä½•ä½¿ç”¨æ­¤å·¥å…·ã€‚
::

ä¾‹å¦‚ï¼š

```ts twoslash
// @noErrors
import { expect, it } from 'vitest'
import type { Component } from 'vue'

declare module '#components' {
  export const SomeComponent: Component
}
// ---cut---
// tests/components/SomeComponents.nuxt.spec.ts
import { mountSuspended } from '@nuxt/test-utils/runtime'
import { SomeComponent } from '#components'

it('can mount some component', async () => {
  const component = await mountSuspended(SomeComponent)
  expect(component.text()).toMatchInlineSnapshot(
    '"This is an auto-imported component"',
  )
})
```

```ts twoslash
// @noErrors
import { expect, it } from 'vitest'
// ---cut---
// tests/components/SomeComponents.nuxt.spec.ts
import { mountSuspended } from '@nuxt/test-utils/runtime'
import App from '~/app.vue'

// tests/App.nuxt.spec.ts
it('can also mount an app', async () => {
  const component = await mountSuspended(App, { route: '/test' })
  expect(component.html()).toMatchInlineSnapshot(`
      "<div>This is an auto-imported component</div>
      <div> I am a global component </div>
      <div>/</div>
      <a href="/test"> Test link </a>"
    `)
})
```

#### `renderSuspended`

`renderSuspended` å…è®¸ä½ åœ¨ Nuxt ç¯å¢ƒä¸­ä½¿ç”¨ `@testing-library/vue` æ¥æ¸²æŸ“ä»»æ„ Vue ç»„ä»¶ï¼Œæ”¯æŒå¼‚æ­¥è®¾ç½®å¹¶èƒ½è®¿é—®æ¥è‡ª Nuxt æ’ä»¶çš„æ³¨å…¥ã€‚

è¯¥æ–¹æ³•åº”ä¸ Testing Library çš„å®ç”¨å·¥å…·ï¼ˆä¾‹å¦‚ `screen` å’Œ `fireEvent`ï¼‰ä¸€èµ·ä½¿ç”¨ã€‚è¯·åœ¨ä½ çš„é¡¹ç›®ä¸­å®‰è£… [@testing-library/vue](https://testing-library.com/docs/vue-testing-library/intro/) ä»¥ä½¿ç”¨è¿™äº›åŠŸèƒ½ã€‚

æ­¤å¤–ï¼ŒTesting Library è¿˜ä¾èµ–æµ‹è¯•å…¨å±€å˜é‡æ¥è¿›è¡Œæ¸…ç†ã€‚ä½ åº”åœ¨ä½ çš„ [Vitest é…ç½®](https://vitest.dev/config/globals) ä¸­å¯ç”¨è¿™äº›å…¨å±€å˜é‡ã€‚

ä¼ å…¥çš„ç»„ä»¶å°†åœ¨ä¸€ä¸ª `<div id="test-wrapper"></div>` å†…æ¸²æŸ“ã€‚

ç¤ºä¾‹ï¼š

```ts twoslash
// @noErrors
import { expect, it } from 'vitest'
import type { Component } from 'vue'

declare module '#components' {
  export const SomeComponent: Component
}
// ---cut---
// tests/components/SomeComponents.nuxt.spec.ts
import { renderSuspended } from '@nuxt/test-utils/runtime'
import { SomeComponent } from '#components'
import { screen } from '@testing-library/vue'

it('can render some component', async () => {
  await renderSuspended(SomeComponent)
  expect(screen.getByText('This is an auto-imported component')).toBeDefined()
})
```

```ts twoslash
// @noErrors
import { expect, it } from 'vitest'
// ---cut---
// tests/App.nuxt.spec.ts
import { renderSuspended } from '@nuxt/test-utils/runtime'
import App from '~/app.vue'

it('can also render an app', async () => {
  const html = await renderSuspended(App, { route: '/test' })
  expect(html).toMatchInlineSnapshot(`
    "<div id="test-wrapper">
      <div>This is an auto-imported component</div>
      <div> I am a global component </div>
      <div>Index page</div><a href="/test"> Test link </a>
    </div>"
  `)
})
```

#### `mockNuxtImport`

`mockNuxtImport` å…è®¸ä½ æ¨¡æ‹Ÿ Nuxt çš„è‡ªåŠ¨å¯¼å…¥åŠŸèƒ½ã€‚ä¾‹å¦‚ï¼Œè¦æ¨¡æ‹Ÿ `useStorage`ï¼Œå¯ä»¥è¿™æ ·åšï¼š

```ts twoslash
import { mockNuxtImport } from '@nuxt/test-utils/runtime'

mockNuxtImport('useStorage', () => {
  return () => {
    return { value: 'mocked storage' }
  }
})

// your tests here
```

::note
`mockNuxtImport` åœ¨æ¯ä¸ªæµ‹è¯•æ–‡ä»¶ä¸­æ¯ä¸ªè¢«æ¨¡æ‹Ÿçš„å¯¼å…¥åªèƒ½ä½¿ç”¨ä¸€æ¬¡ã€‚å®ƒå®é™…ä¸Šæ˜¯ä¸€ä¸ªå®ï¼Œä¼šè¢«è½¬æ¢ä¸º `vi.mock`ï¼Œè€Œ `vi.mock` ä¼šè¢«æå‡ï¼Œè¯¦è§ [Vitest æ–‡æ¡£](https://vitest.dev/api/vi#vi-mock)ã€‚
::

å¦‚æœä½ éœ€è¦åœ¨ä¸åŒæµ‹è¯•ä¹‹é—´ä¸º Nuxt å¯¼å…¥æä¾›ä¸åŒçš„å®ç°ï¼Œå¯ä»¥é€šè¿‡åˆ›å»ºå¹¶æš´éœ²ä½ çš„æ¨¡æ‹Ÿï¼ˆä½¿ç”¨ [`vi.hoisted`](https://vitest.dev/api/vi#vi-hoisted)ï¼‰æ¥å®ç°ï¼Œç„¶ååœ¨ `mockNuxtImport` ä¸­ä½¿ç”¨è¿™äº›æ¨¡æ‹Ÿã€‚è¿™æ ·ä½ å¯ä»¥è®¿é—®è¢«æ¨¡æ‹Ÿçš„å¯¼å…¥ï¼Œå¹¶åœ¨æµ‹è¯•ä¹‹é—´æ›´æ”¹å®ç°ã€‚æ³¨æ„åœ¨æ¯ä¸ªæµ‹è¯•å‰åæ¢å¤æ¨¡æ‹ŸçŠ¶æ€ä»¥æ’¤é”€æ¨¡æ‹Ÿçš„çŠ¶æ€æ›´æ”¹ï¼ˆå‚è§ [restore mocks](https://vitest.dev/api/mock#mockrestore)ï¼‰ã€‚

```ts twoslash
import { vi } from 'vitest'
import { mockNuxtImport } from '@nuxt/test-utils/runtime'

const { useStorageMock } = vi.hoisted(() => {
  return {
    useStorageMock: vi.fn(() => {
      return { value: 'mocked storage' }
    }),
  }
})

mockNuxtImport('useStorage', () => {
  return useStorageMock
})

// Then, inside a test
useStorageMock.mockImplementation(() => {
  return { value: 'something else' }
})
```

#### `mockComponent`

`mockComponent` å…è®¸ä½ æ¨¡æ‹Ÿ Nuxt çš„ç»„ä»¶ã€‚  
ç¬¬ä¸€ä¸ªå‚æ•°å¯ä»¥æ˜¯ PascalCase çš„ç»„ä»¶åï¼Œæˆ–ç»„ä»¶çš„ç›¸å¯¹è·¯å¾„ã€‚  
ç¬¬äºŒä¸ªå‚æ•°æ˜¯è¿”å›è¢«æ¨¡æ‹Ÿç»„ä»¶çš„å·¥å‚å‡½æ•°ã€‚

ä¾‹å¦‚ï¼Œè¦æ¨¡æ‹Ÿ `MyComponent`ï¼Œä½ å¯ä»¥ï¼š

```ts twoslash
import { mockComponent } from '@nuxt/test-utils/runtime'

mockComponent('MyComponent', {
  props: {
    value: String,
  },
  setup (props) {
    // ...
  },
})

// ç›¸å¯¹è·¯å¾„æˆ–åˆ«åä¹Ÿå¯
mockComponent('~/components/my-component.vue', () => {
  // æˆ–è€…ä¸€ä¸ªå·¥å‚å‡½æ•°
  return defineComponent({
    setup (props) {
      // ...
    },
  })
})

// æˆ–è€…ä½ å¯ä»¥ä½¿ç”¨ SFC å°†å…¶é‡å®šå‘åˆ°ä¸€ä¸ªæ¨¡æ‹Ÿç»„ä»¶
mockComponent('MyComponent', () => import('./MockComponent.vue'))

// your tests here
```

> æ³¨æ„ï¼šå·¥å‚å‡½æ•°ç”±äºä¼šè¢«æå‡ï¼Œä¸èƒ½åœ¨å…¶ä¸­å¼•ç”¨æœ¬åœ°å˜é‡ã€‚å¦‚æœä½ éœ€è¦è®¿é—® Vue API æˆ–å…¶ä»–å˜é‡ï¼Œéœ€è¦åœ¨å·¥å‚å‡½æ•°ä¸­å¯¼å…¥å®ƒä»¬ã€‚

```ts twoslash
import { mockComponent } from '@nuxt/test-utils/runtime'

mockComponent('MyComponent', async () => {
  const { ref, h } = await import('vue')

  return defineComponent({
    setup (props) {
      const counter = ref(0)
      return () => h('div', null, counter.value)
    },
  })
})
```

#### `registerEndpoint`

`registerEndpoint` å…è®¸ä½ åˆ›å»ºè¿”å›æ¨¡æ‹Ÿæ•°æ®çš„ Nitro æ¥å£ã€‚å½“ä½ æƒ³æµ‹è¯•ä¸€ä¸ªå‘ API å‘èµ·è¯·æ±‚ä»¥æ˜¾ç¤ºæ•°æ®çš„ç»„ä»¶æ—¶ï¼Œè¿™éå¸¸æœ‰ç”¨ã€‚

ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æ¥å£åç§°ï¼ˆä¾‹å¦‚ `/test/`ï¼‰ã€‚  
ç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸€ä¸ªè¿”å›æ¨¡æ‹Ÿæ•°æ®çš„å·¥å‚å‡½æ•°ã€‚

ä¾‹å¦‚ï¼Œè¦æ¨¡æ‹Ÿ `/test/` æ¥å£ï¼Œä½ å¯ä»¥ï¼š

```ts twoslash
import { registerEndpoint } from '@nuxt/test-utils/runtime'

registerEndpoint('/test/', () => ({
  test: 'test-field',
}))
```

é»˜è®¤æƒ…å†µä¸‹ï¼Œè¯·æ±‚å°†ä½¿ç”¨ `GET` æ–¹æ³•ã€‚ä½ å¯ä»¥é€šè¿‡å°†ç¬¬äºŒä¸ªå‚æ•°è®¾ç½®ä¸ºå¯¹è±¡ï¼ˆè€Œä¸æ˜¯å‡½æ•°ï¼‰æ¥ä½¿ç”¨å…¶ä»–æ–¹æ³•ã€‚

```ts twoslash
import { registerEndpoint } from '@nuxt/test-utils/runtime'

registerEndpoint('/test/', {
  method: 'POST',
  handler: () => ({ test: 'test-field' }),
})
```

> æ³¨æ„ï¼šå¦‚æœä½ çš„ç»„ä»¶ä¸­çš„è¯·æ±‚æŒ‡å‘å¤–éƒ¨ APIï¼Œä½ å¯ä»¥ä½¿ç”¨ `baseURL`ï¼Œç„¶åä½¿ç”¨ [Nuxt ç¯å¢ƒè¦†ç›–é…ç½®](/docs/4.x/getting-started/configuration#environment-overrides)ï¼ˆ`$test`ï¼‰å°†å…¶ç½®ç©ºï¼Œè¿™æ ·ä½ çš„æ‰€æœ‰è¯·æ±‚éƒ½ä¼šæŒ‡å‘ Nitro æœåŠ¡å™¨ã€‚

#### ä¸ç«¯åˆ°ç«¯æµ‹è¯•çš„å†²çª

`@nuxt/test-utils/runtime` å’Œ `@nuxt/test-utils/e2e` éœ€è¦åœ¨ä¸åŒçš„æµ‹è¯•ç¯å¢ƒä¸­è¿è¡Œï¼Œå› æ­¤ä¸èƒ½åœ¨åŒä¸€ä¸ªæ–‡ä»¶ä¸­åŒæ—¶ä½¿ç”¨ã€‚

å¦‚æœä½ æƒ³åŒæ—¶ä½¿ç”¨ `@nuxt/test-utils` çš„ç«¯åˆ°ç«¯å’Œå•å…ƒæµ‹è¯•åŠŸèƒ½ï¼Œå¯ä»¥å°†æµ‹è¯•æ‹†åˆ†åˆ°ä¸åŒçš„æ–‡ä»¶ä¸­ã€‚ç„¶åä½ å¯ä»¥ä¸ºæ¯ä¸ªæ–‡ä»¶ç”¨ç‰¹æ®Šæ³¨é‡ŠæŒ‡å®šæµ‹è¯•ç¯å¢ƒ `// @vitest-environment nuxt`ï¼Œæˆ–è€…å°†è¿è¡Œæ—¶å•å…ƒæµ‹è¯•æ–‡ä»¶å‘½åä¸º `.nuxt.spec.ts` æ‰©å±•åã€‚

`app.nuxt.spec.ts`

```ts twoslash
import { mockNuxtImport } from '@nuxt/test-utils/runtime'

mockNuxtImport('useStorage', () => {
  return () => {
    return { value: 'mocked storage' }
  }
})
```

`app.e2e.spec.ts`

```ts twoslash
import { $fetch, setup } from '@nuxt/test-utils/e2e'

await setup({
  setupTimeout: 10000,
})

// ...
```

### ä½¿ç”¨ `@vue/test-utils`

å¦‚æœä½ æ›´æ„¿æ„å•ç‹¬ä½¿ç”¨ `@vue/test-utils` åœ¨ Nuxt ä¸­è¿›è¡Œå•å…ƒæµ‹è¯•ï¼Œä¸”ä½ ä»…æµ‹è¯•ä¸ä¾èµ– Nuxt composablesã€è‡ªåŠ¨å¯¼å…¥æˆ–ä¸Šä¸‹æ–‡çš„ç»„ä»¶ï¼Œå¯ä»¥æŒ‰ä»¥ä¸‹æ­¥éª¤è®¾ç½®ã€‚

1. å®‰è£…æ‰€éœ€ä¾èµ–

   ::code-group{sync="pm"}
   ```bash [npm]
   npm i --save-dev vitest @vue/test-utils happy-dom @vitejs/plugin-vue
   ```
   ```bash [yarn]
   yarn add --dev vitest @vue/test-utils happy-dom @vitejs/plugin-vue
   ```
   ```bash [pnpm]
   pnpm add -D vitest @vue/test-utils happy-dom @vitejs/plugin-vue
   ```
   ```bash [bun]
   bun add --dev vitest @vue/test-utils happy-dom @vitejs/plugin-vue
   ```
   ::

2. åˆ›å»ºä¸€ä¸ªåŒ…å«ä»¥ä¸‹å†…å®¹çš„ `vitest.config.ts`ï¼š

   ```ts
   import { defineConfig } from 'vitest/config'
   import vue from '@vitejs/plugin-vue'

   export default defineConfig({
     plugins: [vue()],
     test: {
       environment: 'happy-dom',
     },
   })
   ```

3. åœ¨ä½ çš„ `package.json` ä¸­æ·»åŠ ä¸€ä¸ªæµ‹è¯•è„šæœ¬

   ```json
   "scripts": {
     "build": "nuxt build",
     "dev": "nuxt dev",
     ...
     "test": "vitest"
   },
   ```

4. åˆ›å»ºä¸€ä¸ªç®€å•çš„ `<HelloWorld>` ç»„ä»¶ `app/components/HelloWorld.vue`ï¼Œå†…å®¹å¦‚ä¸‹ï¼š

   ```vue
   <template>
     <p>Hello world</p>
   </template>
   ```

5. ä¸ºè¿™ä¸ªæ–°å»ºç»„ä»¶åˆ›å»ºä¸€ä¸ªç®€å•çš„å•å…ƒæµ‹è¯• `~/components/HelloWorld.spec.ts`

   ```ts twoslash
   import { describe, expect, it } from 'vitest'
   import { mount } from '@vue/test-utils'

   import HelloWorld from './HelloWorld.vue'

   describe('HelloWorld', () => {
     it('component renders Hello world properly', () => {
       const wrapper = mount(HelloWorld)
       expect(wrapper.text()).toContain('Hello world')
     })
   })
   ```

6. è¿è¡Œ vitest å‘½ä»¤

   ::code-group{sync="pm"}
   ```bash [npm]
   npm run test
   ```
   ```bash [yarn]
   yarn test
   ```
   ```bash [pnpm]
   pnpm run test
   ```
   ```bash [bun]
   bun run test
   ```
   ::

æ­å–œï¼Œä½ ç°åœ¨å·²å‡†å¤‡å¥½åœ¨ Nuxt ä¸­ä½¿ç”¨ `@vue/test-utils` è¿›è¡Œå•å…ƒæµ‹è¯•ï¼ç¥æµ‹è¯•æ„‰å¿«ï¼

## ç«¯åˆ°ç«¯æµ‹è¯•

å¯¹äºç«¯åˆ°ç«¯æµ‹è¯•ï¼Œæˆ‘ä»¬æ”¯æŒ [Vitest](https://github.com/vitest-dev/vitest)ã€[Jest](https://jestjs.io)ã€[Cucumber](https://cucumber.io/) å’Œ [Playwright](https://playwright.dev/) ä½œä¸ºæµ‹è¯•è¿è¡Œå™¨ã€‚

### è®¾ç½®

åœ¨æ¯ä¸ªä½¿ç”¨ `@nuxt/test-utils/e2e` è¾…åŠ©æ–¹æ³•çš„ `describe` å—ä¸­ï¼Œä½ éœ€è¦åœ¨å¼€å§‹ä¹‹å‰è®¾ç½®æµ‹è¯•ä¸Šä¸‹æ–‡ã€‚

```ts twoslash [test/my-test.spec.ts]
import { describe, test } from 'vitest'
import { $fetch, setup } from '@nuxt/test-utils/e2e'

describe('My test', async () => {
  await setup({
    // test context options
  })

  test('my test', () => {
    // ...
  })
})
```

åœ¨èƒŒåï¼Œ`setup` ä¼šåœ¨ `beforeAll`ã€`beforeEach`ã€`afterEach` å’Œ `afterAll` ä¸­æ‰§è¡Œä¸€ç³»åˆ—ä»»åŠ¡ï¼Œä»¥æ­£ç¡®è®¾ç½® Nuxt æµ‹è¯•ç¯å¢ƒã€‚

è¯·ä½¿ç”¨ä¸‹é¢åˆ—å‡ºçš„ `setup` æ–¹æ³•é€‰é¡¹ã€‚

#### Nuxt é…ç½®

- `rootDir`ï¼šè¦è¿›è¡Œæµ‹è¯•çš„ Nuxt åº”ç”¨ç›®å½•è·¯å¾„ã€‚
  - ç±»å‹ï¼š`string`
  - é»˜è®¤ï¼š`'.'`
- `configFile`ï¼šé…ç½®æ–‡ä»¶çš„åç§°ã€‚
  - ç±»å‹ï¼š`string`
  - é»˜è®¤ï¼š`'nuxt.config'`

<!--
- `config`: Object with configuration overrides.
  - Type: `NuxtConfig`
  - Default: `{}` -->

#### æ—¶é—´è®¾ç½®

- `setupTimeout`ï¼šå…è®¸è¿è¡Œ `setupTest` å®Œæˆå·¥ä½œçš„æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰ï¼Œè¿™å¯èƒ½åŒ…æ‹¬ä¸º Nuxt åº”ç”¨æ„å»ºæˆ–ç”Ÿæˆæ–‡ä»¶ï¼Œå…·ä½“å–å†³äºä¼ å…¥çš„é€‰é¡¹ã€‚
  - ç±»å‹ï¼š`number`
  - é»˜è®¤ï¼š`120000`ï¼ˆWindows ä¸Šä¸º `240000`ï¼‰

- `teardownTimeout`ï¼šå…è®¸æ‹†é™¤æµ‹è¯•ç¯å¢ƒï¼ˆå¦‚å…³é—­æµè§ˆå™¨ï¼‰æ‰€éœ€çš„æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰ã€‚
  - ç±»å‹ï¼š`number`
  - é»˜è®¤ï¼š`30000`

#### åŠŸèƒ½é€‰é¡¹

- `build`ï¼šæ˜¯å¦è¿è¡Œå•ç‹¬çš„æ„å»ºæ­¥éª¤ã€‚
  - ç±»å‹ï¼š`boolean`
  - é»˜è®¤ï¼š`true`ï¼ˆå½“ `browser` æˆ– `server` è¢«ç¦ç”¨ï¼Œæˆ–æä¾›äº† `host` æ—¶ä¸º `false`ï¼‰

- `server`ï¼šæ˜¯å¦å¯åŠ¨ä¸€ä¸ªæœåŠ¡å™¨ä»¥å“åº”æµ‹è¯•å¥—ä»¶ä¸­çš„è¯·æ±‚ã€‚
  - ç±»å‹ï¼š`boolean`
  - é»˜è®¤ï¼š`true`ï¼ˆå½“æä¾› `host` æ—¶ä¸º `false`ï¼‰

- `port`ï¼šå¦‚æœæä¾›ï¼Œå°†æŠŠå¯åŠ¨çš„æµ‹è¯•æœåŠ¡å™¨ç«¯å£è®¾ç½®ä¸ºè¯¥å€¼ã€‚
  - ç±»å‹ï¼š`number | undefined`
  - é»˜è®¤ï¼š`undefined`

- `host`ï¼šå¦‚æœæä¾›ï¼Œåˆ™ä½¿ç”¨è¯¥ URL ä½œä¸ºæµ‹è¯•ç›®æ ‡ï¼Œè€Œä¸æ˜¯æ„å»ºå¹¶è¿è¡Œæ–°çš„æœåŠ¡å™¨ã€‚é€‚ç”¨äºå¯¹å·²éƒ¨ç½²çš„åº”ç”¨æˆ–å·²åœ¨æœ¬åœ°è¿è¡Œçš„æœåŠ¡å™¨è¿›è¡Œâ€œçœŸå®â€çš„ç«¯åˆ°ç«¯æµ‹è¯•ï¼ˆé€šå¸¸èƒ½æ˜¾è‘—å‡å°‘æµ‹è¯•æ‰§è¡Œæ—¶é—´ï¼‰ã€‚å‚è§ä¸‹é¢çš„ [ç›®æ ‡ä¸»æœºç«¯åˆ°ç«¯ç¤ºä¾‹](/docs/4.x/getting-started/testing#target-host-end-to-end-example)ã€‚
  - ç±»å‹ï¼š`string`
  - é»˜è®¤ï¼š`undefined`

- `browser`ï¼šåœ¨åº•å±‚ï¼ŒNuxt æµ‹è¯•å·¥å…·ä½¿ç”¨ [`playwright`](https://playwright.dev) è¿›è¡Œæµè§ˆå™¨æµ‹è¯•ã€‚å¦‚æœè®¾ç½®æ­¤é€‰é¡¹ï¼Œå°†ä¼šå¯åŠ¨ä¸€ä¸ªæµè§ˆå™¨ï¼Œå¹¶å¯åœ¨éšåæµ‹è¯•å¥—ä»¶ä¸­è¿›è¡Œæ§åˆ¶ã€‚
  - ç±»å‹ï¼š`boolean`
  - é»˜è®¤ï¼š`false`
- `browserOptions`
  - ç±»å‹ï¼šåŒ…å«ä»¥ä¸‹å±æ€§çš„ `object`
    - `type`ï¼šè¦å¯åŠ¨çš„æµè§ˆå™¨ç±»å‹ â€”â€” `chromium`ã€`firefox` æˆ– `webkit`
    - `launch`ï¼šåœ¨å¯åŠ¨æµè§ˆå™¨æ—¶å°†ä¼ é€’ç»™ playwright çš„é€‰é¡¹å¯¹è±¡ã€‚å‚è§ [å®Œæ•´ API å‚è€ƒ](https://playwright.dev/docs/api/class-browsertype#browser-type-launch)ã€‚
- `runner`ï¼šä¸ºæµ‹è¯•å¥—ä»¶æŒ‡å®šè¿è¡Œå™¨ã€‚ç›®å‰å»ºè®®ä½¿ç”¨ [Vitest](https://vitest.dev)ã€‚
  - ç±»å‹ï¼š`'vitest' | 'jest' | 'cucumber'`
  - é»˜è®¤ï¼š`'vitest'`

##### ç›®æ ‡ `host` ç«¯åˆ°ç«¯ç¤ºä¾‹

ç«¯åˆ°ç«¯æµ‹è¯•çš„å¸¸è§ç”¨ä¾‹æ˜¯åœ¨ä¸ä½ é€šå¸¸ç”¨äºç”Ÿäº§çš„ç¯å¢ƒç›¸åŒçš„ç¯å¢ƒä¸­å¯¹å·²éƒ¨ç½²çš„åº”ç”¨è¿è¡Œæµ‹è¯•ã€‚

åœ¨æœ¬åœ°å¼€å‘æˆ–è‡ªåŠ¨éƒ¨ç½²æµæ°´çº¿ä¸­ï¼Œå¯¹ä¸€ä¸ªå•ç‹¬çš„æœ¬åœ°æœåŠ¡å™¨è¿›è¡Œæµ‹è¯•é€šå¸¸æ›´åŠ é«˜æ•ˆï¼Œå¹¶ä¸”é€šå¸¸æ¯”åœ¨æµ‹è¯•é—´è®©æµ‹è¯•æ¡†æ¶é‡æ–°æ„å»ºè¦å¿«å¾ˆå¤šã€‚

è¦ä¸ºç«¯åˆ°ç«¯æµ‹è¯•ä½¿ç”¨å•ç‹¬çš„ç›®æ ‡ä¸»æœºï¼Œåªéœ€åœ¨ `setup` å‡½æ•°ä¸­æä¾›æ‰€éœ€ URL çš„ `host` å±æ€§ã€‚

```ts
import { createPage, setup } from '@nuxt/test-utils/e2e'
import { describe, expect, it } from 'vitest'

describe('login page', async () => {
  await setup({
    host: 'http://localhost:8787',
  })

  it('displays the email and password fields', async () => {
    const page = await createPage('/login')
    expect(await page.getByTestId('email').isVisible()).toBe(true)
    expect(await page.getByTestId('password').isVisible()).toBe(true)
  })
})
```

### API

#### `$fetch(url)`

è·å–æœåŠ¡ç«¯æ¸²æŸ“é¡µé¢çš„ HTMLã€‚

```ts twoslash
import { $fetch } from '@nuxt/test-utils/e2e'

const html = await $fetch('/')
```

#### `fetch(url)`

è·å–æœåŠ¡ç«¯æ¸²æŸ“é¡µé¢çš„å“åº”ã€‚

```ts twoslash
import { fetch } from '@nuxt/test-utils/e2e'

const res = await fetch('/')
const { body, headers } = res
```

#### `url(path)`

è·å–ç»™å®šé¡µé¢çš„å®Œæ•´ URLï¼ˆåŒ…æ‹¬æµ‹è¯•æœåŠ¡å™¨è¿è¡Œçš„ç«¯å£ï¼‰ã€‚

```ts twoslash
import { url } from '@nuxt/test-utils/e2e'

const pageUrl = url('/page')
// 'http://localhost:6840/page'
```

### åœ¨æµè§ˆå™¨ä¸­æµ‹è¯•

æˆ‘ä»¬åœ¨ `@nuxt/test-utils` ä¸­ä¸º Playwright æä¾›äº†å†…ç½®æ”¯æŒï¼Œå¯ä»¥ä»¥ç¼–ç¨‹æ–¹å¼æˆ–é€šè¿‡ Playwright æµ‹è¯•è¿è¡Œå™¨ä½¿ç”¨ã€‚

#### `createPage(url)`

åœ¨ `vitest`ã€`jest` æˆ– `cucumber` ä¸­ï¼Œä½ å¯ä»¥ä½¿ç”¨ `createPage` åˆ›å»ºä¸€ä¸ªå·²é…ç½®çš„ Playwright æµè§ˆå™¨å®ä¾‹ï¼Œå¹¶ï¼ˆå¯é€‰ï¼‰å°†å…¶æŒ‡å‘æ­£åœ¨è¿è¡Œçš„æœåŠ¡å™¨çš„æŸä¸ªè·¯å¾„ã€‚ä½ å¯ä»¥åœ¨ [Playwright æ–‡æ¡£](https://playwright.dev/docs/api/class-page) ä¸­äº†è§£æ›´å¤šå¯ç”¨çš„ API æ–¹æ³•ã€‚

```ts twoslash
import { createPage } from '@nuxt/test-utils/e2e'

const page = await createPage('/page')
// ä½ å¯ä»¥é€šè¿‡ `page` å˜é‡è®¿é—®æ‰€æœ‰ Playwright API
```

#### ä½¿ç”¨ Playwright æµ‹è¯•è¿è¡Œå™¨è¿›è¡Œæµ‹è¯•

æˆ‘ä»¬ä¹Ÿä¸ºåœ¨ [Playwright æµ‹è¯•è¿è¡Œå™¨](https://playwright.dev/docs/intro) ä¸­æµ‹è¯• Nuxt æä¾›äº†é«˜çº§æ”¯æŒã€‚

::code-group{sync="pm"}
```bash [npm]
npm i --save-dev @playwright/test @nuxt/test-utils
```
```bash [yarn]
yarn add --dev @playwright/test @nuxt/test-utils
```
```bash [pnpm]
pnpm add -D @playwright/test @nuxt/test-utils
```
```bash [bun]
bun add --dev @playwright/test @nuxt/test-utils
```
```bash [deno]
deno add --dev npm:@playwright/test npm:@nuxt/test-utils
```
::

ä½ å¯ä»¥æä¾›å…¨å±€ Nuxt é…ç½®ï¼Œæ ¼å¼ä¸å‰é¢æåˆ°çš„ `setup()` å‡½æ•°ç›¸åŒã€‚

```ts [playwright.config.ts]
import { fileURLToPath } from 'node:url'
import { defineConfig, devices } from '@playwright/test'
import type { ConfigOptions } from '@nuxt/test-utils/playwright'

export default defineConfig<ConfigOptions>({
  use: {
    nuxt: {
      rootDir: fileURLToPath(new URL('.', import.meta.url)),
    },
  },
  // ...
})
```

::read-more{title="æŸ¥çœ‹å®Œæ•´ç¤ºä¾‹é…ç½®" to="https://github.com/nuxt/test-utils/blob/main/examples/app-playwright/playwright.config.ts" target="_blank"}
::

ç„¶åä½ çš„æµ‹è¯•æ–‡ä»¶åº”è¯¥ç›´æ¥ä» `@nuxt/test-utils/playwright` ä½¿ç”¨ `expect` å’Œ `test`ï¼š

```ts [tests/example.test.ts]
import { expect, test } from '@nuxt/test-utils/playwright'

test('test', async ({ page, goto }) => {
  await goto('/', { waitUntil: 'hydration' })
  await expect(page.getByRole('heading')).toHaveText('Welcome to Playwright!')
})
```

ä½ ä¹Ÿå¯ä»¥åœ¨æµ‹è¯•æ–‡ä»¶å†…ç›´æ¥é…ç½® Nuxt æœåŠ¡å™¨ï¼š

```ts [tests/example.test.ts]
import { expect, test } from '@nuxt/test-utils/playwright'

test.use({
  nuxt: {
    rootDir: fileURLToPath(new URL('..', import.meta.url)),
  },
})

test('test', async ({ page, goto }) => {
  await goto('/', { waitUntil: 'hydration' })
  await expect(page.getByRole('heading')).toHaveText('Welcome to Playwright!')
})
```
