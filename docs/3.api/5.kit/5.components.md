---
title: "组件"
description: Nuxt Kit 提供了一组实用工具来帮助您处理组件。您可以全局或局部注册组件，也可以添加要扫描组件的目录。
links:
  - label: 源码
    icon: i-simple-icons-github
    to: https://github.com/nuxt/nuxt/blob/main/packages/kit/src/components.ts
    size: xs
---

组件是 Nuxt 应用的构建块。它们是可重用的 Vue 实例，可用于创建用户界面。在 Nuxt 中，components 目录下的组件默认会被自动导入。但如果您需要从替代目录导入组件，或希望按需选择性地导入组件，`@nuxt/kit` 提供了 `addComponentsDir` 和 `addComponent` 方法。这些工具允许您自定义组件配置，以更好地满足您的需求。

::tip{icon="i-lucide-video" to="https://vueschool.io/lessons/injecting-components-and-component-directories?friend=nuxt" target="_blank"}
观看关于注入组件的 Vue School 视频。
::

## `addComponentsDir`

注册一个目录以扫描组件，并在仅使用时导入。请注意，除非您指定 `global: true` 选项，否则这不会将组件注册为全局组件。

### 用法

```ts
export default defineNuxtModule({
  meta: {
    name: '@nuxt/ui',
    configKey: 'ui',
  },
  setup () {
    addComponentsDir({
      path: resolve('./runtime/components'),
      prefix: 'U',
      pathPrefix: false,
    })
  },
})
```

### 类型

```ts
function addComponentsDir (dir: ComponentsDir, opts: { prepend?: boolean } = {}): void
```

### 参数

`dir` 一个包含以下属性的对象：

| 属性               | 类型                         | 必填     | 描述                                                                                                           |
| ------------------ | ---------------------------- | -------- | -------------------------------------------------------------------------------------------------------------- |
| `path`             | `string`                     | `true`   | 包含组件的目录路径（绝对或相对）。您可以使用 Nuxt 别名（~ 或 @）来引用项目内的目录，或直接使用类似于 require 的 npm 包路径。 |
| `pattern`          | `string \| string[]`{lang="ts"}          | `false`  | 要针对指定路径运行的匹配模式。                                                                                 |
| `ignore`           | `string[]`                   | `false`  | 要针对指定路径运行的忽略模式。                                                                                 |
| `prefix`           | `string`                     | `false`  | 用此字符串为所有匹配的组件添加前缀。                                                                            |
| `pathPrefix`       | `boolean`                    | `false`  | 通过其路径为组件名称添加前缀。                                                                                 |
| `prefetch`         | `boolean`                    | `false`  | 这些属性（prefetch/preload）在生产环境中用于配置带有 Lazy 前缀的组件如何通过 webpack 的魔法注释进行处理。更多信息见 [webpack 文档](https://webpack.js.org/api/module-methods/#magic-comments) |
| `preload`          | `boolean`                    | `false`  | 这些属性（prefetch/preload）在生产环境中用于配置带有 Lazy 前缀的组件如何通过 webpack 的魔法注释进行处理。更多信息见 [webpack 文档](https://webpack.js.org/api/module-methods/#magic-comments) |
| `isAsync`          | `boolean`                    | `false`  | 此标志表示组件应异步加载（使用单独的 chunk），无论是否使用 Lazy 前缀。                                         |
| `extendComponent`  | `(component: Component) => Promise<Component \| void> \| (Component \| void)`{lang="ts"} | `false`  | 每个在目录中发现的组件都会调用此函数。它接受一个组件对象并应返回一个组件对象或解析为组件对象的 Promise。         |
| `global`           | `boolean`                    | `false`  | 启用后，将组件注册为全局可用。                                                                                  |
| `island`           | `boolean`                    | `false`  | 启用后，将组件注册为 island。您可以在 [`<NuxtIsland/>`](/docs/4.x/api/components/nuxt-island) 组件说明中阅读有关 islands 的更多信息。 |
| `watch`            | `boolean`                    | `false`  | 监听指定路径的更改，包括文件添加和删除。                                                                        |
| `extensions`       | `string[]`                   | `false`  | Nuxt 构建器支持的扩展名。                                                                                      |
| `transpile`        | `'auto' \| boolean`{lang="ts"} | `false`  | 使用 build.transpile 转译指定路径。如果设置为 `'auto'`，则当路径中包含 `node_modules/` 时会将 `transpile: true` 设置为 true。 |

`opts`

| 属性               | 类型                         | 必填     | 描述                                                                                                           |
| ------------------ | ---------------------------- | -------- | -------------------------------------------------------------------------------------------------------------- |
| `prepend`          | `boolean`                    | `false`  | 如果设置为 `true`，则该目录将使用 `unshift()` 添加到数组前端，而不是使用 `push()` 添加到数组末尾。               |

## `addComponent`

注册一个组件以实现自动导入。

### 用法

```ts
import { addComponent, createResolver, defineNuxtModule } from '@nuxt/kit'

export default defineNuxtModule({
  meta: {
    name: '@nuxt/image',
    configKey: 'image',
  },
  setup () {
    const resolver = createResolver(import.meta.url)

    addComponent({
      name: 'NuxtImg',
      filePath: resolver.resolve('./runtime/components/NuxtImg.vue'),
    })

    addComponent({
      name: 'NuxtPicture',
      filePath: resolver.resolve('./runtime/components/NuxtPicture.vue'),
    })
  },
})
```

### 类型

```ts
function addComponent (options: AddComponentOptions): void
```

### 参数

`options`：一个包含以下属性的对象：

| 属性               | 类型                         | 必填     | 描述                                                                                                           |
| ------------------ | ---------------------------- | -------- | -------------------------------------------------------------------------------------------------------------- |  
| `name`             | `string`                     | `true`   | 组件名称。                                                                                                     |
| `filePath`         | `string`                     | `true`   | 组件路径。                                                                                                     |
| `declarationPath`  | `string`                     | `false`  | 组件的声明文件路径。用于生成组件的 [类型模板](/docs/4.x/api/kit/templates#addtypetemplate)；如果未提供，将使用 `filePath`。 |
| `pascalName`       | `string`                     | `false`  | PascalCase 的组件名称。如果未提供，将从组件名称生成。                                                           |
| `kebabName`        | `string`                     | `false`  | kebab-case 的组件名称。如果未提供，将从组件名称生成。                                                           |
| `export`           | `string`                     | `false`  | 指定命名导出或默认导出。如果未提供，将设置为 `'default'`。                                                     |
| `shortPath`        | `string`                     | `false`  | 组件的短路径。如果未提供，将从组件路径生成。                                                                   |
| `chunkName`        | `string`                     | `false`  | 组件的 chunk 名称。如果未提供，将从组件名称生成。                                                               |
| `prefetch`         | `boolean`                    | `false`  | 这些属性（prefetch/preload）在生产环境中用于配置带有 Lazy 前缀的组件如何通过 webpack 的魔法注释进行处理。更多信息见 [webpack 文档](https://webpack.js.org/api/module-methods/#magic-comments) |  
| `preload`          | `boolean`                    | `false`  | 这些属性（prefetch/preload）在生产环境中用于配置带有 Lazy 前缀的组件如何通过 webpack 的魔法注释进行处理。更多信息见 [webpack 文档](https://webpack.js.org/api/module-methods/#magic-comments) |
| `global`           | `boolean`                    | `false`  | 启用后，将该组件注册为全局可用。                                                                                |
| `island`           | `boolean`                    | `false`  | 启用后，将该组件注册为 island。您可以在 [`<NuxtIsland/>`](/docs/4.x/api/components/nuxt-island) 组件说明中阅读有关 islands 的更多信息。 |
| `mode`             | `'client' \| 'server' \| 'all'`{lang="ts"} | `false`  | 此选项指示组件应在客户端、服务器还是两者都渲染。默认情况下，组件将在客户端和服务器上都渲染。                      |
| `priority`         | `number`                     | `false`  | 组件的优先级：如果多个组件具有相同的名称，将使用优先级最高的组件。                                               |

### 示例

如果您希望从 npm 包自动导入一个组件，并且该组件是命名导出（而不是默认导出），您可以使用 `export` 选项来指定它。

```ts
import { addComponent, defineNuxtModule } from '@nuxt/kit'

export default defineNuxtModule({
  setup () {
    // import { MyComponent as MyAutoImportedComponent } from 'my-npm-package'
    addComponent({
      name: 'MyAutoImportedComponent',
      export: 'MyComponent',
      filePath: 'my-npm-package',
    })
  },
})
```
