---
title: 解析路径
description: Nuxt Kit 提供了一组实用工具来帮助你解析路径。这些函数允许你解析相对于当前模块的路径，支持未知名称或扩展名。
links:
  - label: 源码
    icon: i-simple-icons-github
    to: https://github.com/nuxt/nuxt/blob/main/packages/kit/src/resolve.ts
    size: xs
---

有时候你需要解析路径：相对于当前模块，且名称或扩展名未知。例如，你可能想添加一个位于与模块相同目录下的插件。为处理这些情况，Nuxt 提供了一套解析路径的实用工具。`resolvePath` 和 `resolveAlias` 用于解析相对于当前模块的路径。`findPath` 用于在给定路径中寻找第一个存在的文件。`createResolver` 用于创建基于基础路径的解析器。

## `resolvePath`

解析文件或目录的完整路径，支持 Nuxt 的别名和扩展名配置。如果路径无法解析，将返回规范化后的输入路径。

### 用法

```ts
import { defineNuxtModule, resolvePath } from '@nuxt/kit'

export default defineNuxtModule({
  async setup () {
    const entrypoint = await resolvePath('@unhead/vue')
    console.log(`Unhead 入口点为 ${entrypoint}`)
  },
})
```

### 类型

```ts
function resolvePath (path: string, options?: ResolvePathOptions): Promise<string>
```

### 参数

**`path`**：需要解析的路径。

**`options`**：传递给解析器的选项对象。该对象包含以下属性：

| 属性名               | 类型                                | 是否必需 | 描述                                                                                                                      |
| -------------------- | ----------------------------------- | -------- | -------------------------------------------------------------------------------------------------------------------------- |
| `cwd`                | `string`                            | `false`  | 解析路径的基准目录。默认是 Nuxt 的 rootDir。                                                                             |
| `alias`              | `Record<string, string>`{lang="ts"} | `false`  | 别名对象。默认使用 Nuxt 配置的别名。                                                                                      |
| `extensions`         | `string[]`                          | `false`  | 尝试的文件扩展名。默认使用 Nuxt 配置的扩展名。                                                                           |
| `virtual`            | `boolean`                           | `false`  | 是否解析存在于 Nuxt 虚拟文件系统（例如，Nuxt 模板中的文件）的文件。                                                       |
| `fallbackToOriginal` | `boolean`                           | `false`  | 如果解析的路径不存在，是否回退到原始路径，而不是返回规范化后的输入路径。                                                 |

### 示例

```ts
import { defineNuxtModule, resolvePath } from '@nuxt/kit'
import { join } from 'pathe'

const headlessComponents: ComponentGroup[] = [
  {
    relativePath: 'combobox/combobox.js',
    chunkName: 'headlessui/combobox',
    exports: [
      'Combobox',
      'ComboboxLabel',
      'ComboboxButton',
      'ComboboxInput',
      'ComboboxOptions',
      'ComboboxOption',
    ],
  },
]

export default defineNuxtModule({
  meta: {
    name: 'nuxt-headlessui',
    configKey: 'headlessui',
  },
  defaults: {
    prefix: 'Headless',
  },
  async setup (options) {
    const entrypoint = await resolvePath('@headlessui/vue')
    const root = join(entrypoint, '../components')

    for (const group of headlessComponents) {
      for (const e of group.exports) {
        addComponent(
          {
            name: e,
            export: e,
            filePath: join(root, group.relativePath),
            chunkName: group.chunkName,
            mode: 'all',
          },
        )
      }
    }
  },
})
```

## `resolveAlias`

根据 Nuxt 的别名配置解析路径别名。

### 类型

```ts
function resolveAlias (path: string, alias?: Record<string, string>): string
```

### 参数

**`path`**：需要解析的路径。

**`alias`**：别名对象。如果未提供，则会从 `nuxt.options.alias` 中读取。

## `findPath`

尝试解析给定路径列表中第一个存在的文件。

### 用法

```ts
import { defineNuxtModule, findPath } from '@nuxt/kit'
import { join } from 'pathe'

export default defineNuxtModule({
  async setup (_, nuxt) {
    // 解析主文件 (app.vue)
    const mainComponent = await findPath([
      join(nuxt.options.srcDir, 'App'),
      join(nuxt.options.srcDir, 'app'),
    ])
  },
})
```

### 类型

```ts
function findPath (paths: string | string[], options?: ResolvePathOptions, pathType: 'file' | 'dir'): Promise<string | null>
```

### 参数

**`paths`**：需要解析的路径或路径数组。

**`options`**：传递给解析器的选项对象。该对象包含以下属性：

| 属性名               | 类型                                | 是否必需 | 描述                                                                                                                      |
| -------------------- | ----------------------------------- | -------- | -------------------------------------------------------------------------------------------------------------------------- |
| `cwd`                | `string`                            | `false`  | 解析路径的基准目录。默认是 Nuxt 的 rootDir。                                                                             |
| `alias`              | `Record<string, string>`{lang="ts"} | `false`  | 别名对象。默认使用 Nuxt 配置的别名。                                                                                      |
| `extensions`         | `string[]`                          | `false`  | 尝试的文件扩展名。默认使用 Nuxt 配置的扩展名。                                                                           |
| `virtual`            | `boolean`                           | `false`  | 是否解析存在于 Nuxt 虚拟文件系统（例如，Nuxt 模板中的文件）的文件。                                                       |
| `fallbackToOriginal` | `boolean`                           | `false`  | 如果解析的路径不存在，是否回退到原始路径，而不是返回规范化后的输入路径。                                                 |

## `createResolver`

创建基于基础路径的解析器。

::tip{icon="i-lucide-video" to="https://vueschool.io/lessons/resolving-paths-and-injecting-assets-to-the-app?friend=nuxt" target="_blank"}
观看 Vue School 视频，了解关于 createResolver 的内容。
::

### 用法

```ts
import { defineNuxtModule, createResolver } from '@nuxt/kit'

export default defineNuxtModule({
  async setup (_, nuxt) {
    const { resolve, resolvePath } = createResolver(import.meta.url)
  },
})
```

### 类型

```ts
function createResolver (basePath: string | URL): Resolver
```

### 参数

**`basePath`**：要解析的基准路径，可以是字符串或 URL。

### 返回值

`createResolver` 函数返回一个包含以下属性的对象：

| 属性名        | 类型                                                                         | 描述                                                                                       |
| ------------- | ---------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------ |
| `resolve`     | `(path: string) => string`{lang="ts"}                                        | 一个函数，用于相对于基准路径解析路径。                                                     |
| `resolvePath` | `(path: string, options?: ResolvePathOptions) => Promise<string>`{lang="ts"} | 一个函数，用于相对于基准路径解析路径，支持 Nuxt 的别名和扩展名选项。                       |

### 示例

```ts
import { createResolver, defineNuxtModule, isNuxt2 } from '@nuxt/kit'

export default defineNuxtModule({
  setup (options, nuxt) {
    const resolver = createResolver(import.meta.url)

    nuxt.hook('modules:done', () => {
      if (isNuxt2()) {
        addPlugin(resolver.resolve('./runtime/plugin.vue2'))
      } else {
        addPlugin(resolver.resolve('./runtime/plugin.vue3'))
      }
    })
  },
})
```