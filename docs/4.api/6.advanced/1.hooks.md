---
title: '生命周期钩子'
description: Nuxt 提供了一个强大的钩子系统，可以通过钩子扩展几乎每个方面。
---

:read-more{to="/docs/4.x/guide/going-further/hooks"}

## 应用钩子（运行时）

查看 [app 源代码](https://github.com/nuxt/nuxt/blob/main/packages/nuxt/src/app/nuxt.ts#L37) 以获取所有可用的钩子。

Hook                   | 参数                 | 环境           | 描述
-----------------------|---------------------|-----------------|-------------
`app:created`          | `vueApp`            | 服务器 & 客户端 | 在初始 `vueApp` 实例创建时调用。
`app:error`            | `err`               | 服务器 & 客户端 | 在发生致命错误时调用。
`app:error:cleared`    | `{ redirect? }`     | 服务器 & 客户端 | 在致命错误被清除时调用。
`vue:setup`            | -                   | 服务器 & 客户端 | Nuxt 根的 setup 初始化时调用。此回调必须是同步的。
`vue:error`            | `err, target, info` | 服务器 & 客户端 | 当 Vue 错误传播到根组件时调用。[了解更多](https://vuejs.org/api/composition-api-lifecycle#onerrorcaptured)。
`app:rendered`         | `renderContext`     | 服务器          | SSR 渲染完成时调用。
`app:redirected`       | -                   | 服务器          | SSR 重定向前调用。
`app:beforeMount`      | `vueApp`            | 客户端          | 挂载应用前调用，仅在客户端执行。
`app:mounted`          | `vueApp`            | 客户端          | Vue 应用初始化并挂载到浏览器时调用。
`app:suspense:resolve` | `appComponent`      | 客户端          | 在 [Suspense](https://vuejs.org/guide/built-ins/suspense#suspense) 解析事件时调用。
`app:manifest:update`  | `{ id, timestamp }` | 客户端          | 当检测到应用有新版本时调用。
`app:data:refresh`     | `keys?`             | 客户端          | 当调用 `refreshNuxtData` 时调用。
`link:prefetch`        | `to`                | 客户端          | 当观察到 `<NuxtLink>` 被预取时调用。
`page:start`           | `pageComponent?`    | 客户端          | 在 `NuxtPage` 中的 [Suspense](https://vuejs.org/guide/built-ins/suspense#suspense) 挂起事件时调用。
`page:finish`          | `pageComponent?`    | 客户端          | 在 `NuxtPage` 中的 [Suspense](https://vuejs.org/guide/built-ins/suspense#suspense) 解析事件时调用。
`page:loading:start`   | -                   | 客户端          | 当新页面的 `setup()` 正在运行时调用。
`page:loading:end`     | -                   | 客户端          | 在 `page:finish` 之后调用。
`page:transition:finish`| `pageComponent?`    | 客户端          | 页面过渡的 [onAfterLeave](https://vuejs.org/guide/built-ins/transition#javascript-hooks) 事件之后调用。
`dev:ssr-logs`         | `logs`              | 客户端          | 当服务器端日志传递给客户端时调用（如果启用了 `features.devLogs`）。
`page:view-transition:start` | `transition`   | 客户端          | 当调用 `document.startViewTransition` 后调用（当启用了[实验性视图过渡支持](/docs/4.x/getting-started/transitions#view-transitions-api-experimental) 时）。

## Nuxt 钩子（构建时）

查看 [schema 源代码](https://github.com/nuxt/nuxt/blob/main/packages/schema/src/types/hooks.ts#L83) 以获取所有可用钩子。

Hook                     | 参数                              | 描述
-------------------------|----------------------------------|-------------
`kit:compatibility`      | `compatibility, issues`           | 用于扩展兼容性检查。
`ready`                  | `nuxt`                           | Nuxt 初始化完成，实例已准备好工作时调用。
`close`                  | `nuxt`                           | Nuxt 实例优雅关闭时调用。
`restart`                | `{ hard?: boolean }`             | 用于重启当前 Nuxt 实例。
`modules:before`         | -                                | Nuxt 初始化时，安装用户模块之前调用。
`modules:done`           | -                                | Nuxt 初始化时，安装用户模块之后调用。
`app:resolve`            | `app`                           | 解析 `app` 实例后调用。
`app:templates`          | `app`                           | 在生成 `NuxtApp` 期间调用，允许自定义、修改或添加新文件到构建目录（虚拟或写入 `.nuxt`）。
`app:templatesGenerated` | `app`                           | 模板编译进 [虚拟文件系统](/docs/4.x/directory-structure/nuxt) (vfs) 后调用。
`build:before`           | -                                | Nuxt 打包构建前调用。
`build:done`             | -                                | Nuxt 打包构建完成后调用。
`build:manifest`         | `manifest`                      | 在 Vite 和 webpack 生成清单时调用，允许自定义 Nitro 用于渲染最终 HTML 中 `<script>` 和 `<link>` 标签的清单。
`builder:generateApp`    | `options`                      | 生成应用前调用。
`builder:watch`          | `event, path`                  | 开发构建时，当观察器检测到项目文件或目录变动时调用。
`pages:extend`           | `pages`                        | 文件系统扫描页面路由后调用。
`pages:resolved`         | `pages`                        | 页面路由已添加扫描元数据后调用。
`pages:routerOptions`   | `{ files: Array<{ path: string, optional?: boolean }> }` | 解析 `router.options` 文件时调用，后续数组项会覆盖前面。
`server:devHandler`      | `handler`                      | 在 Nitro 开发服务器上注册开发中间件时调用。
`imports:sources`        | `presets`                      | 设置阶段允许模块扩展导入源。
`imports:extend`         | `imports`                      | 设置阶段允许模块扩展导入。
`imports:context`        | `context`                      | 当创建 [unimport](https://github.com/unjs/unimport) 上下文时调用。
`imports:dirs`           | `dirs`                         | 允许扩展导入目录。
`components:dirs`        | `dirs`                         | 在 `app:resolve` 内部调用，允许扩展自动导入组件扫描目录。
`components:extend`      | `components`                   | 允许扩展新组件。
`nitro:config`           | `nitroConfig`                  | Nitro 初始化前调用，允许定制 Nitro 配置。
`nitro:init`             | `nitro`                       | Nitro 初始化后调用，允许注册 Nitro 钩子及直接与 Nitro 交互。
`nitro:build:before`     | `nitro`                       | 构建 Nitro 实例前调用。
`nitro:build:public-assets` | `nitro`                    | 复制公共资源后调用，允许在 Nitro 服务器构建前修改公共资源。
`prerender:routes`       | `ctx`                         | 允许扩展预渲染路由。
`build:error`            | `error`                       | 构建时发生错误时调用。
`prepare:types`          | `options`                     | 在 `@nuxt/cli` 写入 TypeScript 配置文件（`.nuxt/tsconfig.app.json`、`.nuxt/tsconfig.server.json` 等）及 `.nuxt/nuxt.d.ts` 前调用，允许添加自定义引用、声明或直接修改生成配置中的选项。
`listen`                 | `listenerServer, listener`    | 开发服务器启动时调用。
`schema:extend`          | `schemas`                     | 允许扩展默认 schema。
`schema:resolved`        | `schema`                      | 允许扩展已解析的 schema。
`schema:beforeWrite`     | `schema`                      | 在写入给定 schema 前调用。
`schema:written`         | -                             | schema 写入后调用。
`vite:extend`            | `viteBuildContext`            | 允许扩展 Vite 默认上下文。
`vite:extendConfig`      | `viteInlineConfig, env`       | 允许扩展 Vite 默认配置。**Nuxt 5+ 已废弃。** 在 Nuxt 5 中，此钩子作用于共享配置而非独立的客户端/服务器配置。
`vite:configResolved`    | `viteInlineConfig, env`       | 允许读取已解析的 Vite 配置。**Nuxt 5+ 已废弃。** 在 Nuxt 5 中，此钩子作用于共享配置而非独立的客户端/服务器配置。
`vite:serverCreated`     | `viteServer, env`             | Vite 服务器创建时调用。
`vite:compiled`          | -                             | Vite 服务器编译完成后调用。
`webpack:config`         | `webpackConfigs`              | 配置 webpack 编译器前调用。
`webpack:configResolved` | `webpackConfigs`              | 允许读取已解析的 webpack 配置。
`webpack:compile`        | `options`                    | 编译前调用。
`webpack:compiled`       | `options`                    | 资源加载后调用。
`webpack:change`         | `shortPath`                  | WebpackBar 监听 `change` 时调用。
`webpack:error`          | -                             | WebpackBar 完成时若有错误调用。
`webpack:done`           | -                             | WebpackBar 全部完成时调用。
`webpack:progress`       | `statesArray`                | WebpackBar 进度事件时调用。

## Nitro 应用钩子（运行时，服务器端）

参考 [Nitro](https://nitro.build/guide/plugins#available-hooks) 获取所有可用钩子。

Hook                   | 参数                       | 描述                                     | 类型
-----------------------|----------------------------|------------------------------------------|------------------
`dev:ssr-logs`         | `{ path, logs }`           | 服务器端                                 | 请求周期结束时调用，带有传递给客户端的服务器日志数组。
`render:response`      | `response, { event }`      | 在发送响应之前调用。                      | [response](https://github.com/nuxt/nuxt/blob/71ef8bd3ff207fd51c2ca18d5a8c7140476780c7/packages/nuxt/src/core/runtime/nitro/renderer.ts#L24), [event](https://github.com/h3js/h3/blob/f6ceb5581043dc4d8b6eab91e9be4531e0c30f8e/src/types.ts#L38)
`render:html`          | `html, { event }`          | 在构建 HTML 之前调用。                  | [html](https://github.com/nuxt/nuxt/blob/71ef8bd3ff207fd51c2ca18d5a8c7140476780c7/packages/nuxt/src/core/runtime/nitro/renderer.ts#L15), [event](https://github.com/h3js/h3/blob/f6ceb5581043dc4d8b6eab91e9be4531e0c30f8e/src/types.ts#L38)
`render:island`        | `islandResponse, { event, islandContext }` | 在构建 island HTML 之前调用。         | [islandResponse](https://github.com/nuxt/nuxt/blob/e50cabfed1984c341af0d0c056a325a8aec26980/packages/nuxt/src/core/runtime/nitro/renderer.ts#L28), [event](https://github.com/h3js/h3/blob/f6ceb5581043dc4d8b6eab91e9be4531e0c30f8e/src/types.ts#L38), [islandContext](https://github.com/nuxt/nuxt/blob/e50cabfed1984c341af0d0c056a325a8aec26980/packages/nuxt/src/core/runtime/nitro/renderer.ts#L38)
`close`               | -                          | Nitro 关闭时调用。                        | -
`error`               | `error, { event? }`        | 发生错误时调用。                          | [error](https://github.com/nitrojs/nitro/blob/d20ffcbd16fc4003b774445e1a01e698c2bb078a/src/types/runtime/nitro.ts#L48), [event](https://github.com/h3js/h3/blob/f6ceb5581043dc4d8b6eab91e9be4531e0c30f8e/src/types.ts#L38)
`request`             | `event`                    | 收到请求时调用。                          | [event](https://github.com/h3js/h3/blob/f6ceb5581043dc4d8b6eab91e9be4531e0c30f8e/src/types.ts#L38)
`beforeResponse`      | `event, { body }`          | 发送响应前调用。                          | [event](https://github.com/h3js/h3/blob/f6ceb5581043dc4d8b6eab91e9be4531e0c30f8e/src/types.ts#L38), unknown
`afterResponse`       | `event, { body }`          | 发送响应后调用。                          | [event](https://github.com/h3js/h3/blob/f6ceb5581043dc4d8b6eab91e9be4531e0c30f8e/src/types.ts#L38), unknown